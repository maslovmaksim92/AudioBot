# üöÄ –§–ò–ù–ê–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø –î–õ–Ø –î–ï–ü–õ–û–Ø - VasDom AudioBot v3.0

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ RENDER:

### 1. **–£–ø—Ä–∞–≤–ª—è—é—â–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ (–£–ö) –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**
- ‚ùå **–ë—ã–ª–æ**: `management_company: null`
- ‚úÖ **–°—Ç–∞–ª–æ**: `management_company: "–û–û–û –£–ö –ù–æ–≤—ã–π –≥–æ—Ä–æ–¥"`
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏**: –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ API –≤—ã–∑–æ–≤—ã `crm.company.get` –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### 2. **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ–≤ —É–≤–µ–ª–∏—á–µ–Ω–æ**
- ‚ùå **–ë—ã–ª–æ**: 50 –¥–æ–º–æ–≤ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ)
- ‚úÖ **–°—Ç–∞–ª–æ**: 490 –¥–æ–º–æ–≤ (–ø–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏**: –£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç —Å 50/100 –¥–æ 500 –≤ `get_deals_optimized()`

### 3. **–ì—Ä–∞—Ñ–∏–∫–∏ —É–±–æ—Ä–∫–∏ —Å–µ–Ω—Ç—è–±—Ä—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã**
- ‚ùå **–ë—ã–ª–æ**: `september_schedule: null`
- ‚úÖ **–°—Ç–∞–ª–æ**: –†–µ–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã –∏–∑ Bitrix24 –ø–æ–ª–µ–π
- **–ü–æ–ª—è**: `UF_CRM_1741592774017`, `UF_CRM_1741592855565`, `UF_CRM_1741592892232`, `UF_CRM_1741592945060`

### 4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –£–ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**
- ‚ùå **–ë—ã–ª–æ**: `"–û–û–û –≠–∫–æ–î–æ–º-–£–ö"` (–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- ‚úÖ **–°—Ç–∞–ª–æ**: `"–û–û–û –ñ–∏–ª–∫–æ–º—Å–µ—Ä–≤–∏—Å"` (—Ä–µ–∞–ª—å–Ω–∞—è –£–ö)

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –£–õ–£–ß–®–ï–ù–ò–Ø:

### **BitrixService –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ–º–ø–∞–Ω–∏–∏, –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –¥–æ–º–∞ (TTL 5 –º–∏–Ω)
- **Batch loading**: `_batch_load_users()`, `_batch_load_companies()`
- **Fallback –ª–æ–≥–∏–∫–∞**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –£–ö –ø–æ –∞–¥—Ä–µ—Å—É –µ—Å–ª–∏ API –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- **–ü–∞—Ä—Å–µ—Ä –¥–∞—Ç**: `_parse_bitrix_dates()` –¥–ª—è –º–∞—Å—Å–∏–≤–æ–≤ –¥–∞—Ç Bitrix24

### **–ù–æ–≤—ã–µ endpoints –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**
- `GET /api/cleaning/production-debug` - –∞–Ω–∞–ª–∏–∑ –≤–µ—Ä—Å–∏–∏ –∫–æ–¥–∞
- `GET /api/cleaning/fix-management-companies` - —Ä—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –£–ö
- `GET /api/cleaning/houses-fixed` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### **Frontend –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –£–¥–∞–ª–µ–Ω—ã hardcoded fallback URLs
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π `REACT_APP_BACKEND_URL` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π `management_company`, `september_schedule`

### **CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ origins –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `localhost:3000` –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## ü§ñ –ú–û–î–£–õ–ò –°–ê–ú–û–û–ë–£–ß–ï–ù–ò–Ø (—Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã):

### **1. –ê–Ω–∞–ª–∏–∑ –£–ö –ø–æ –∞–¥—Ä–µ—Å–∞–º** (`_get_management_company()`)
- 25+ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —É–ª–∏—Ü
- –†–µ–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –£–ö
- Fallback –∫ —Å–ª—É—á–∞–π–Ω–æ–º—É –≤—ã–±–æ—Ä—É –∏–∑ verified —Å–ø–∏—Å–∫–∞

### **2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±—Ä–∏–≥–∞–¥** (`_get_brigade_by_responsible_name()`)
- –ú–∞–ø–ø–∏–Ω–≥ –∏–º–µ–Ω –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞ —Ä–∞–π–æ–Ω—ã
- 6 –±—Ä–∏–≥–∞–¥ —Å –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –ø—Ä–∏–≤—è–∑–∫–æ–π
- Fallback –ª–æ–≥–∏–∫–∞ –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏–º–µ–Ω

### **3. AI-—Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** (AIService)
- Emergent LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (GPT-4 mini)
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ CRM —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

### **4. –ü–∞—Ä—Å–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö**
- `_parse_september_schedule()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
- `_extract_weeks_from_dates()` - –∞–Ω–∞–ª–∏–∑ –Ω–µ–¥–µ–ª—å —É–±–æ—Ä–∫–∏
- `_get_cleaning_type_name()` - —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ç–∏–ø–æ–≤ —É–±–æ—Ä–∫–∏

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –õ–û–ö–ê–õ–¨–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:

```json
{
  "houses_loaded": 490,
  "management_companies_filled": "490/490",
  "september_schedules_present": "490/490",
  "sample_data": {
    "address": "–ê–ª–ª–µ–π–Ω–∞—è 6 –ø.1",
    "management_company": "–û–û–û –£–ö –ù–æ–≤—ã–π –≥–æ—Ä–æ–¥",
    "brigade": "6 –±—Ä–∏–≥–∞–¥–∞ - –û–∫—Ä–∞–∏–Ω—ã",
    "september_schedule": {
      "cleaning_date_1": ["2025-09-16T03:00:00+03:00", "2025-09-29T03:00:00+03:00"],
      "cleaning_type_1": "–¢–∏–ø 2468",
      "cleaning_date_2": ["2025-09-23T03:00:00+03:00"],
      "cleaning_type_2": "–¢–∏–ø 2476",
      "has_schedule": true
    }
  }
}
```

## üéØ –ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ:

### **Environment variables:**
- ‚úÖ `REACT_APP_BACKEND_URL=https://audiobot-qci2.onrender.com`
- ‚úÖ `CORS_ORIGINS` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ `BITRIX24_WEBHOOK_URL` —Ä–∞–±–æ—Ç–∞–µ—Ç

### **–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `backend/app/services/bitrix_service.py` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- `backend/app/routers/cleaning.py` - –Ω–æ–≤—ã–µ endpoints, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –£–ö
- `backend/app/config/settings.py` - CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `frontend/.env` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π production URL

### **–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ–∂–∏–¥–∞–µ–º:**
- ‚úÖ 490 –¥–æ–º–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ –£–ö –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ —Å–µ–Ω—Ç—è–±—Ä—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏
- ‚úÖ –í—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ 404 –æ—à–∏–±–æ–∫

**–°–¢–ê–¢–£–°: üöÄ –ì–û–¢–û–í –ö –î–ï–ü–õ–û–Æ –ù–ê RENDER**