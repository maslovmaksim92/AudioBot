# ‚úÖ –ò—Ç–µ—Ä–∞—Ü–∏—è 2 –ó–ê–í–ï–†–®–ï–ù–ê: Telegram –±–æ—Ç –¥–ª—è –±—Ä–∏–≥–∞–¥ (–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)

## –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
12 –æ–∫—Ç—è–±—Ä—è 2025 –≥.

## –¶–µ–ª—å –∏—Ç–µ—Ä–∞—Ü–∏–∏
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Telegram –±–æ—Ç–∞ –¥–ª—è –±—Ä–∏–≥–∞–¥: –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ ‚Üí AI –ø–æ–¥–ø–∏—Å—å –æ—Ç GPT-4o-mini ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (—Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º)

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –û–±–Ω–æ–≤–ª—ë–Ω Photo Caption Service –¥–ª—è GPT-4o-mini

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –£–¥–∞–ª—ë–Ω Vision API (–Ω–µ –Ω—É–∂–µ–Ω –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `generate_motivational_text()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–æ—Ç–∏–≤–∏—Ä—É—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ GPT-4o-mini
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `generate_caption()` - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—É—é –ø–æ–¥–ø–∏—Å—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ PostingFotoTG:
  ```
  üßπ –£–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
  üè† –ê–¥—Ä–µ—Å: [–∞–¥—Ä–µ—Å]
  üìÖ –î–∞—Ç–∞: [–¥–µ–Ω—å –º–µ—Å—è—Ü –≥–æ–¥]
  üë∑ –ë—Ä–∏–≥–∞–¥–∞: #[–Ω–æ–º–µ—Ä]
  
  [GPT-4o-mini: –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π —Ç–µ–∫—Å—Ç]
  #–ß–∏—Å—Ç–æ—Ç–∞ #–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å #–°–æ—Ü–∏–∞–ª—å–Ω–∞—è–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å #–ö–∞–ª—É–≥–∞
  ```
- –û–±–Ω–æ–≤–ª—ë–Ω `_generate_fallback_caption()` –ø–æ–¥ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ `format_cleaning_completion_message()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `brigade_number`

**–ú–æ–¥–µ–ª—å:**
- **GPT-4o-mini** - –±—ã—Å—Ç—Ä–∞—è, –¥–µ—à—ë–≤–∞—è, –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –¥–ª—è —Ç–µ–∫—Å—Ç–∞
- **Temperature**: 0.9 (–±–æ–ª—å—à–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏)
- **Max tokens**: 200

**–§–∞–π–ª:** `/app/backend/app/services/photo_caption_service.py`

---

### 2. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª Telegram –±–æ—Ç–∞

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:**

#### `/start` - –°–ø–∏—Å–æ–∫ –¥–æ–º–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ–º–æ–≤ –¥–ª—è –±—Ä–∏–≥–∞–¥—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
- Inline –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–æ–º–∞
- –°–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–§–∞–π–ª:** `telegram_cleaning_bot.py::handle_start_command()`

#### –í—ã–±–æ—Ä –¥–æ–º–∞ (callback)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –∞–¥—Ä–µ—Å
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å–µ—Å—Å–∏—é: `house_id`, `address`
- –û—á–∏—â–∞—é—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ–æ—Ç–æ
- –ü—Ä–æ—Å–∏—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ
- **–§–∞–π–ª:** `telegram_cleaning_bot.py::handle_house_selection()`

#### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–æ—Ç–æ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç `file_id` –≤ —Å–µ—Å—Å–∏—é
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏–µ
- **–§–∞–π–ª:** `telegram_cleaning_bot.py::handle_photo()`

#### `/done` - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É–±–æ—Ä–∫–∏
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç AI –ø–æ–¥–ø–∏—Å—å —á–µ—Ä–µ–∑ `photo_caption_service`
- **–¢–ï–°–¢–û–í–´–ô –†–ï–ñ–ò–ú**: –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (–Ω–µ –≤ –≥—Ä—É–ø–ø—É)
- –ï—Å–ª–∏ 1 —Ñ–æ—Ç–æ ‚Üí `sendPhoto`
- –ï—Å–ª–∏ 2+ —Ñ–æ—Ç–æ ‚Üí `sendMediaGroup`
- –û—á–∏—â–∞–µ—Ç —Å–µ—Å—Å–∏—é
- **–§–∞–π–ª:** `telegram_cleaning_bot.py::handle_done_command()`

**–§–∞–π–ª—ã:**
- `/app/backend/app/services/telegram_cleaning_bot.py` (–æ–±–Ω–æ–≤–ª—ë–Ω)
- `/app/backend/app/routers/telegram_webhook.py` (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã)

---

### 3. Webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- `POST /api/telegram-webhook/` - –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç Telegram
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
  * `message.text` ‚Üí –∫–æ–º–∞–Ω–¥—ã (`/start`, `/done`)
  * `message.photo` ‚Üí —Ñ–æ—Ç–æ
  * `callback_query` ‚Üí inline –∫–Ω–æ–ø–∫–∏ (–≤—ã–±–æ—Ä –¥–æ–º–∞)

**–§–∞–π–ª:** `/app/backend/app/routers/telegram_webhook.py` (—É–∂–µ –±—ã–ª, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

### 4. –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞)

**–ë—Ä–∏–≥–∞–¥–∞:**
- `brigade_1` ‚Üí "–ë—Ä–∏–≥–∞–¥–∞ #1"

**–î–æ–º–∞:**
```python
{
  "house_1": {"address": "—É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –ø–æ–¥—ä–µ–∑–¥ 1", "entrances": 1, "floors": 5},
  "house_2": {"address": "—É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 25, –ø–æ–¥—ä–µ–∑–¥—ã 1-3", "entrances": 3, "floors": 9},
  "house_3": {"address": "–ø—Ä. –ú–∏—Ä–∞, –¥. 5, –ø–æ–¥—ä–µ–∑–¥—ã 1-4", "entrances": 4, "floors": 5}
}
```

---

## üìä –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

### –®–∞–≥ 1: `/start`
**–í—Ö–æ–¥:** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`

**–í—ã—Ö–æ–¥:**
```
üè† –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–º –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ:

üìÖ –°–µ–≥–æ–¥–Ω—è: 12.10.2025
üìç –î–æ–º–æ–≤ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è: 3

[Inline –∫–Ω–æ–ø–∫–∏:]
- —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –ø–æ–¥—ä–µ–∑–¥ 1
- —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 25, –ø–æ–¥—ä–µ–∑–¥—ã 1-3
- –ø—Ä. –ú–∏—Ä–∞, –¥. 5, –ø–æ–¥—ä–µ–∑–¥—ã 1-4
```

### –®–∞–≥ 2: –í—ã–±–æ—Ä –¥–æ–º–∞
**–í—Ö–æ–¥:** –Ω–∞–∂–∞—Ç—å "—É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –ø–æ–¥—ä–µ–∑–¥ 1"

**–í—ã—Ö–æ–¥:**
```
‚úÖ –í—ã–±—Ä–∞–Ω –¥–æ–º:
üè† —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –ø–æ–¥—ä–µ–∑–¥ 1
üö™ –ü–æ–¥—ä–µ–∑–¥–æ–≤: 1
üìä –≠—Ç–∞–∂–µ–π: 5

üì∏ –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ —É–±–æ—Ä–∫–∏
–ö–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç–µ, –Ω–∞–∂–º–∏—Ç–µ /done
```

### –®–∞–≥ 3: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
**–í—Ö–æ–¥:** –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 1-3 —Ñ–æ—Ç–æ

**–í—ã—Ö–æ–¥ (–ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ):**
```
‚úÖ –§–æ—Ç–æ 1 —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ
üè† –î–æ–º: —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –ø–æ–¥—ä–µ–∑–¥ 1

üì∏ –û—Ç–ø—Ä–∞–≤—å—Ç–µ –µ—â—ë —Ñ–æ—Ç–æ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ /done –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
```

### –®–∞–≥ 4: `/done`
**–í—Ö–æ–¥:** –æ—Ç–ø—Ä–∞–≤–∏—Ç—å `/done`

**–í—ã—Ö–æ–¥ 1:**
```
‚è≥ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é —Ñ–æ—Ç–æ –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é –ø–æ–¥–ø–∏—Å—å...
```

**–í—ã—Ö–æ–¥ 2 (—Ñ–æ—Ç–æ —Å AI –ø–æ–¥–ø–∏—Å—å—é):**
```
üßπ –£–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
üè† –ê–¥—Ä–µ—Å: —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –ø–æ–¥—ä–µ–∑–¥ 1
üìÖ –î–∞—Ç–∞: 12 –æ–∫—Ç—è–±—Ä—è 2025
üë∑ –ë—Ä–∏–≥–∞–¥–∞: #1

üåøüßπ‚ú® –°–µ–≥–æ–¥–Ω—è –Ω–∞ —É–ª–∏—Ü–µ –õ–µ–Ω–∏–Ω–∞ 10 –º—ã —Å–¥–µ–ª–∞–ª–∏ –º–∏—Ä –Ω–µ–º–Ω–æ–≥–æ —á–∏—â–µ –∏ —Å–≤–µ—Ç–ª–µ–µ! 
–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –Ω–∞—à–∏—Ö —É–±–æ—Ä—â–∏–∫–æ–≤ –∑–∞ –∏—Ö —Ç—Ä—É–¥ –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º. –ß–∏—Å—Ç–æ—Ç–∞ –≤ 
–ø–æ–¥—ä–µ–∑–¥–µ ‚Äî —ç—Ç–æ –∑–∞–±–æ—Ç–∞ –æ –∫–∞–∂–¥–æ–º –∂–∏–ª—å—Ü–µ –∏ —É–≤–∞–∂–µ–Ω–∏–µ –∫ —Å–µ–±–µ. –î–∞–≤–∞–π—Ç–µ –≤–º–µ—Å—Ç–µ 
–¥–µ–ª–∞—Ç—å –º–∏—Ä –ª—É—á—à–µ! üåüüçÉ
#–ß–∏—Å—Ç–æ—Ç–∞ #–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å #–°–æ—Ü–∏–∞–ª—å–Ω–∞—è–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å #–ö–∞–ª—É–≥–∞
```

**–í—ã—Ö–æ–¥ 3:**
```
‚úÖ –£–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
üè† —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –ø–æ–¥—ä–µ–∑–¥ 1
üì∏ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Ñ–æ—Ç–æ: 1

–°–ø–∞—Å–∏–±–æ –∑–∞ —Ä–∞–±–æ—Ç—É! üíô
```

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–µ–ø–ª–æ—é

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
1. ‚úÖ `backend/app/services/photo_caption_service.py` - GPT-4o-mini –¥–ª—è –ø–æ–¥–ø–∏—Å–µ–π
2. ‚úÖ `backend/app/services/telegram_cleaning_bot.py` - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –±–æ—Ç–∞
3. ‚úÖ `backend/app/routers/telegram_webhook.py` - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è Render
- ‚úÖ `OPENAI_API_KEY` - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Render
- ‚ö†Ô∏è `TELEGRAM_BOT_TOKEN` - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ Environment Variables
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook:
  ```bash
  curl -X POST "https://api.telegram.org/bot<TOKEN>/setWebhook" \
    -d "url=https://ai-brain-hub-2.preview.emergentagent.com/api/telegram-webhook/"
  ```

### –°—Ç–∞—Ç—É—Å
- ‚úÖ –ö–æ–¥ –≥–æ—Ç–æ–≤
- ‚úÖ Backend –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ webhook –Ω–∞ –±–æ—Ç–µ
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π `TELEGRAM_BOT_TOKEN`

---

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω–∞ –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:
- **–§–∞–π–ª:** `/app/TELEGRAM_BOT_TEST_INSTRUCTIONS.md`
- **–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
  * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook
  * –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π (—à–∞–≥ –∑–∞ —à–∞–≥–æ–º)
  * –ü—Ä–∏–º–µ—Ä—ã –ø–æ–¥–ø–∏—Å–µ–π –æ—Ç GPT-4o-mini
  * Troubleshooting
  * –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º

---

## üéØ –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: –¢–ï–°–¢–û–í–´–ô –†–ï–ñ–ò–ú

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç:
- –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: `/start` ‚Üí –≤—ã–±–æ—Ä –¥–æ–º–∞ ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ ‚Üí `/done`
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è AI –ø–æ–¥–ø–∏—Å–∏ —á–µ—Ä–µ–∑ GPT-4o-mini
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (–Ω–µ –≤ –≥—Ä—É–ø–ø—É)

### ‚ö†Ô∏è –ú–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
- –°–ø–∏—Å–æ–∫ –¥–æ–º–æ–≤ (—Ö–∞—Ä–¥–∫–æ–¥)
- –ë—Ä–∏–≥–∞–¥–∞ (–≤—Å–µ–≥–¥–∞ "–ë—Ä–∏–≥–∞–¥–∞ #1")
- –¢–∏–ø —É–±–æ—Ä–∫–∏ (–≤—Å–µ–≥–¥–∞ "–í–ª–∞–∂–Ω–∞—è —É–±–æ—Ä–∫–∞")

### üîú –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ò—Ç–µ—Ä–∞—Ü–∏–∏ 2):
1. **–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –≥—Ä—É–ø–ø—É** (–Ω–µ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `TELEGRAM_TARGET_CHAT_ID`
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ `sendMediaGroup` –≤ –≥—Ä—É–ø–ø—É
   
2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL**
   - –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `cleaning_photos`
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å: house_id, brigade_id, photo_urls, caption, status
   
3. **–í–µ–±—Ö—É–∫ –≤ Bitrix24**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É–±–æ—Ä–∫–∏
   - Bitrix24 ‚Üí –ë–ü ‚Üí email –£–ö
   
4. **–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î**
   - –ü–æ–ª—É—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ–º–æ–≤ –ø–æ brigade_id
   - –ü–æ–ª—É—á–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ —É–±–æ—Ä–∫–∏
   - –û–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø —É–±–æ—Ä–∫–∏

---

## üí° –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. –§–æ—Ä–º–∞—Ç –ø–æ–¥–ø–∏—Å–∏ = PostingFotoTG
–ü–æ–¥–ø–∏—Å—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç—É –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è PostingFotoTG:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –£–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Üí –ê–¥—Ä–µ—Å ‚Üí –î–∞—Ç–∞ ‚Üí –ë—Ä–∏–≥–∞–¥–∞ ‚Üí –ú–æ—Ç–∏–≤–∞—Ü–∏—è ‚Üí –•–µ—à—Ç–µ–≥–∏
- –≠–º–æ–¥–∑–∏: üßπ, üè†, üìÖ, üë∑, üåü, üßπ, üí™, üåø, ‚ú®
- –•–µ—à—Ç–µ–≥–∏: #–ß–∏—Å—Ç–æ—Ç–∞ #–ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å #–°–æ—Ü–∏–∞–ª—å–Ω–∞—è–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å #–ö–∞–ª—É–≥–∞

### 2. GPT-4o-mini –≤–º–µ—Å—Ç–æ Vision
- **–ü–æ—á–µ–º—É**: –Ω–µ –Ω—É–∂–µ–Ω –∞–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ, —Ç–æ–ª—å–∫–æ –∫—Ä–∞—Å–∏–≤—ã–π —Ç–µ–∫—Å—Ç
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –±—ã—Å—Ç—Ä–µ–µ, –¥–µ—à–µ–≤–ª–µ, –ø—Ä–æ—â–µ
- **–ü—Ä–æ–º–ø—Ç**: –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π —Ç–µ–∫—Å—Ç –ø—Ä–æ —É–±–æ—Ä–∫—É, –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –±—Ä–∏–≥–∞–¥–µ, –º–æ—Ç–∏–≤–∞—Ü–∏—è

### 3. Fallback –Ω–∞ —Å–ª—É—á–∞–π –æ—à–∏–±–∫–∏ GPT
–ï—Å–ª–∏ GPT –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω:
```
üåü –í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –Ω–∞—à—É –∫–æ–º–∞–Ω–¥—É –∑–∞ —Ç—Ä—É–¥ –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º...
```

### 4. –°–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–•—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (`user_sessions`):
- `user_id` ‚Üí `CleaningSession`
- –°–æ–¥–µ—Ä–∂–∏—Ç: `brigade_id`, `selected_house_id`, `photos[]`
- **–í–Ω–∏–º–∞–Ω–∏–µ**: –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ backend —Å–µ—Å—Å–∏–∏ —Ç–µ—Ä—è—é—Ç—Å—è (–≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis)

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞ –ò—Ç–µ—Ä–∞—Ü–∏–∏ 2

- ‚úÖ **–ö–æ–º–∞–Ω–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç**: `/start`, –≤—ã–±–æ—Ä –¥–æ–º–∞, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ, `/done`
- ‚úÖ **AI –ø–æ–¥–ø–∏—Å—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è**: GPT-4o-mini —Å–æ–∑–¥–∞—ë—Ç –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–π —Ç–µ–∫—Å—Ç
- ‚úÖ **–§–æ—Ä–º–∞—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π**: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç PostingFotoTG
- ‚úÖ **–§–æ—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è**: –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –ø–æ–¥–ø–∏—Å—å—é
- ‚úÖ **–ö–æ–¥ —á–∏—Å—Ç—ã–π**: –±–µ–∑ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞, backend —Å—Ç–∞—Ä—Ç—É–µ—Ç
- ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**: webhook + TELEGRAM_BOT_TOKEN –Ω–∞ Render

---

## üîó –°–ª–µ–¥—É—é—â–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è

**–ò—Ç–µ—Ä–∞—Ü–∏—è 2 (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ) - –ü—Ä–æ–¥–∞–∫—à–µ–Ω —Ä–µ–∂–∏–º:**
1. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –≥—Ä—É–ø–ø—É –≤–º–µ—Å—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `cleaning_photos` –≤ PostgreSQL
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–± —É–±–æ—Ä–∫–µ –≤ –ë–î
4. –í–µ–±—Ö—É–∫ –≤ Bitrix24 –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email –£–ö
5. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î (–±—Ä–∏–≥–∞–¥—ã, –¥–æ–º–∞, –≥—Ä–∞—Ñ–∏–∫–∏)

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2-3 —á–∞—Å–∞ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

## üìÑ –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ–∞–π–ª—ã

- `/app/TELEGRAM_BOT_TEST_INSTRUCTIONS.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
- `/app/DEVELOPMENT_PLAN_ITERATIONS.md` - –ø–æ–ª–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `/app/backend/app/services/photo_caption_service.py` - AI –ø–æ–¥–ø–∏—Å–∏
- `/app/backend/app/services/telegram_cleaning_bot.py` - –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
- `/app/backend/app/routers/telegram_webhook.py` - webhook endpoints

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –¢–ï–°–¢–û–í–´–ô –†–ï–ñ–ò–ú –ì–û–¢–û–í –ö –î–ï–ü–õ–û–Æ

–ë–æ—Ç –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–æ—Ç–æ, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫—Ä–∞—Å–∏–≤—É—é –ø–æ–¥–ø–∏—Å—å —á–µ—Ä–µ–∑ GPT-4o-mini –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ. 
–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ webhook –Ω–∞ Render –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å! üöÄ
