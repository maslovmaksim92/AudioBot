# VasDom AudioBot - Production Render Config
# Максимально обучаемый AI для клининговой компании

services:
  - type: web
    name: vasdom-audiobot
    env: python
    region: oregon
    plan: starter
    buildCommand: |
      # Install Python dependencies
      pip install --upgrade pip && 
      pip install -r requirements.txt &&
      # Install Node.js and Yarn for frontend build
      curl -fsSL https://deb.nodesource.com/setup_18.x | bash - &&
      apt-get install -y nodejs &&
      npm install -g yarn &&
      # Build React frontend
      cd frontend &&
      yarn install &&
      yarn build &&
      echo "✅ Frontend build completed"
    startCommand: |
      uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: EMERGENT_LLM_KEY
        value: sk-emergent-0A408AfAeF26aCd5aB
      - key: EMBEDDING_MODEL
        value: sentence-transformers/paraphrase-multilingual-MiniLM-L6-v2
      - key: MIN_RATING_THRESHOLD
        value: 4
      - key: RETRAINING_THRESHOLD
        value: 3.5
      - key: CORS_ORIGINS
        value: https://audiobot-qci2.onrender.com